# 如何部署 DHCP 服务器？

[toc]

## 一、环境

1. win2003 server、win XP各一台
2. 在虚拟机运行
3. 两台电脑都连上同一块网卡，组成局域网。

## 二、具体操作

* 因为我这里是win2003，所以系统没有自带的 DHCP 相关设置软件。这个软件需要从2003的系统镜像（iso）里面获取。而其他服务器（如2008）会安装了的。

### step1：插入 2003 系统镜像，打开光驱安装应用 --- 选择【安装可选的 Windows 组件】 --- 找到组件下的【网络服务】并双击 --- 找到 【动态主机配置协议（DHCP）】并勾选 --- 然后确定下一步

* 注意 ：如果服务器本身没有设置静态IP的会出现提示使用静态的，弹出框来配置一下静态 IP 就好了（先规划好），服务器的静态 IP 一旦配置好，网段也就确定了！

### step2：打开 开始菜单 --- 所有程序 --- 管理工具 --- DHCP

### step3：对着服务器右键 --- 新建作用域

* 填写的名称可以以公司名称命名。
* IP 地址范围最好有预留一些（如从 21 - 250）
* 地址排除：指的是方才你分配的范围里面有些不想让别人使用的。
* 租期：具体情况而定

完成以上的步骤只配置了：IP、子网掩码、租期。

还有：网关、DNS 这两个称为 DHCP 选项。会提示现在配置这些选项吗？是。

* 配置 DNS 时候，只需填写 DNS 就好了。
* 还有一个配置 WINS 服务器的，不要管他。

### step4：验证

打开 XP ，配置自动获取 IP。

* 如果已经开启自动获取，且有默认的IP了，对着网卡禁用 --- 启用。

## 三、问题

### 1. XP 自动获取的 IP 不是自己服务器配置的

这是因为 XP 连上的服务器，是虚拟机的虚拟网卡上的 DHCP 服务器。怎么解决？

* a 打开 虚拟机 --- 编辑 --- 虚拟网络编辑器。会看到列表的网卡（如果你两台电脑连接的网卡是列表上的，那么虚拟机就会有给它装了 DHCP 服务器）。

* b 右下角 --- 更改设置

* c 选中两台电脑连接的虚拟网卡，把【使用本地DHCP服务 ...】 的勾去掉 --- 确定保存

* d 这时再打开 XP，禁用启用网卡就会连到你配置的 2003 DHCP服务了。

### 2. 自动获取IP情况下，如何重新获取IP？

四种方法：

* 重启电脑

* 禁用启用网卡

* 拔插网线

* 命令

    ```cmd
    ipconfig /release
    ipconfig /renew # 一定要先释放IP，不然只是续约
    ```

### 3. 如果删除作用域的时候误删了服务器怎么办？

右键添加服务器 --- 浏览 --- 高级 --- 立即查找 --- 选择自己服务器的名称 --- 确定
